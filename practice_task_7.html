<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/style7.css">
    <script src="js/jquery-3.4.1.js" type="text/javascript"></script>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Задание №7</title>

    <script type="text/javascript">

        var str = '';

    function validate(evt) {
            var theEvent = evt || window.event;
            var key = theEvent.keyCode || theEvent.which;
            var el = document.getElementById('convertForm1');
            key = String.fromCharCode(key);
            str += key;
            console.log(key);
            console.log('str - "' + str + '"');
            var regex = /^\d+\.?\d{0,2}$/;
        if (!regex.test(str)) {
            theEvent.returnValue = false;
            //str = el.value;
            str = el.value;

            if (theEvent.preventDefault) theEvent.preventDefault();
        }
        el.addEventListener('keydown', function (event) {
           if (event.keyCode === 8) { // BACKSPACE was pressed
               str = el.value;
           }
           if (event.keyCode === 46) { // DELETE was pressed
               str = el.value;
           }
        });
        el.oninput = convert;
    }

        function convert() {
            var conv1 = document.getElementById('convertForm1').value;
            var res   =  conv1 * 1.609;

            if (conv1 === ''){
                res = '';
                document.getElementById('convertForm2').value = res;
            } else {
                document.getElementById('convertForm2').value = res.toFixed(3);
            }
        }

    </script>

</head>
<body>

<div id="main-wrapper" class="main-wrapper">
    <h1>Мили-километры</h1>

    <div class="wrap">
        <div class="mile">
            <input class="convForm1" id="convertForm1" type="text" size="20" onkeypress = "validate(event)"><br/>
            <span class="forMile">Мили</span>
        </div>
        <div class="eqv">=</div>
        <div class="kilo">
            <input class="convForm2" id="convertForm2" type="text" size="20"><br/>
            <span class="forKilo">Километры</span>
        </div>
    </div>

</div>

</body>
</html>